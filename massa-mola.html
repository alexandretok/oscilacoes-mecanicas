<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <style type="text/css">
        canvas {
            border: 1px solid black;
        }
    </style>
    <script type="text/javascript" src="numeric.js"></script>
</head>
<body onload="inicializar()">
    <canvas id="canvas" width="800" height="250">
        Navegador n√£o suporta HTML5
    </canvas>
    <p>
        mX.. + Kx = 0
    </p>
    <script type="text/javascript">
        var canvas, d,  context, tempo, tempoDeAtualizacaoDoCanvas, massaAltura, massaLargura, massa, massaPosicaoX, massaPosicaoXOriginal, massaVelocidade, kMola, x0, xp, teta;

        function inicializar() {
            massaAltura = 200;
            massaLargura = 200;

            x0 = 0.1;
            xp = 0;

            kMola = 10;
            massa = 10;

            massaPosicaoX = 400;
            massaPosicaoXOriginal = 400;

            tempoDeAtualizacaoDoCanvas = 30;
            tempo = 0;

            canvas = document.getElementById("canvas");
            context = canvas.getContext("2d");
            context.font = "bold 16px Arial";

            addEventListener('keydown', keyDown);

            d = setInterval(draw, tempoDeAtualizacaoDoCanvas);
            setInterval(changeValues, tempoDeAtualizacaoDoCanvas);
        }

        function changeValues(){
            tempo += tempoDeAtualizacaoDoCanvas/100;
            massaPosicaoX += Math.sin(tempo) * 30;
        }

        function keyDown(e){
            if(e.keyCode == 39)
                clearInterval(d);
        }

        function draw(){
            context.clearRect(0, 0, canvas.width, canvas.height); /* Limpa a tela */
            context.fillRect(massaPosicaoX, canvas.height - massaAltura, massaLargura, massaAltura); /* Desenha a posicao do jogar */
            /*Desenhando a escala na parte superior*/
            /*Cada ponto na escala equivale a 100px */
            context.beginPath();
            alturaEscala = canvas.height - massaAltura - 10;
            context.moveTo(0, alturaEscala);
            context.lineTo(canvas.width, alturaEscala);
            for(i=0;i<=canvas.width;i+=100){
                context.moveTo(i, alturaEscala);
                if(i == 0)
                    back = 0;
                else if(i == canvas.width)
                    back = i - 10;
                else back = i - 5;
                context.fillText(i/100, back, alturaEscala - 10);
                context.moveTo(i, alturaEscala - 5);
                context.lineTo(i, alturaEscala + 5);
            }


            /* Desenhando a mola */
            /* A mola possui 5 aspirais */
            xAtual = 0;
            yAtual = canvas.height - massaAltura/2;
            y0 = yAtual;
            nAspirais = 10;
            comprimentoAspiral = 7;
            deslocamentoXPixels = (massaPosicaoX - massaPosicaoXOriginal) + 100;
            deslocamentoXPorAspiral = deslocamentoXPixels/(nAspirais*2);
            deslocamentoYPorAspiral = comprimentoAspiral*comprimentoAspiral - Math.sqrt(Math.pow(deslocamentoXPorAspiral, 2));

            context.moveTo(xAtual, yAtual);
            context.lineTo(xAtual += 100, yAtual);

            for(i=0;i<nAspirais/2;i++) {
                /* Desenha as espirais */
                context.lineTo(xAtual += deslocamentoXPorAspiral, yAtual += deslocamentoYPorAspiral);
                context.lineTo(xAtual += deslocamentoXPorAspiral, yAtual = y0);
                context.lineTo(xAtual += deslocamentoXPorAspiral, yAtual -= deslocamentoYPorAspiral);
                context.lineTo(xAtual += deslocamentoXPorAspiral, yAtual = y0);
            }

            context.lineTo(massaPosicaoX, yAtual);


            context.stroke();
        }
    </script>
</body>
</html>